{
  "version": 4,
  "terraform_version": "1.6.2",
  "serial": 186,
  "lineage": "9eb129e2-4972-b0ab-6928-062ba271932f",
  "outputs": {
    "instructions_to_access_environment": {
      "value": "\n\tLogin to the Jumpbox Server using IAP.\n\n\tCredentials\n\t\tRun this command\u003e gcloud secrets versions access latest --secret=example-com-admin --project=sql-test-002-414415\n\n\tIAP Tunnel\n\t\tRun this command\u003e gcloud compute start-iap-tunnel jumpbox 3389 --local-host-port=localhost:50001 --zone=us-central1-f --project=sql-test-002-414415\n\n\t\tAfter the Tunnel is established, use any RDP Client to connect to localhost:50001 and use the Credentials to authenticate to the Jumpbox.",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "managed",
      "type": "google_compute_address",
      "name": "wsfc_cluster_ip",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address": "10.145.0.2",
            "address_type": "INTERNAL",
            "creation_timestamp": "2024-02-15T07:34:03.038-08:00",
            "description": "",
            "id": "projects/sql-test-002-414415/regions/us-central1/addresses/wsfc-cluster-ip",
            "ip_version": "",
            "ipv6_endpoint_type": "",
            "name": "wsfc-cluster-ip",
            "network": "",
            "network_tier": "PREMIUM",
            "prefix_length": 0,
            "project": "sql-test-002-414415",
            "purpose": "GCE_ENDPOINT",
            "region": "us-central1",
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/addresses/wsfc-cluster-ip",
            "subnetwork": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
            "timeouts": null,
            "users": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance",
      "name": "dc1",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 6,
          "attributes": {
            "advanced_machine_features": [],
            "allow_stopping_for_update": true,
            "attached_disk": [],
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "dc1",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "initialize_params": [
                  {
                    "image": "https://www.googleapis.com/compute/v1/projects/windows-cloud/global/images/windows-server-2022-dc-v20240214",
                    "labels": {},
                    "resource_manager_tags": null,
                    "size": 50,
                    "type": "pd-balanced"
                  }
                ],
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/disks/dc1"
              }
            ],
            "can_ip_forward": false,
            "confidential_instance_config": [],
            "cpu_platform": "Intel Cascade Lake",
            "current_status": "RUNNING",
            "deletion_protection": false,
            "description": "",
            "desired_status": null,
            "enable_display": false,
            "guest_accelerator": [],
            "hostname": "",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/dc1",
            "instance_id": "2375744713201521117",
            "label_fingerprint": "42WmSpB8rSM=",
            "labels": null,
            "machine_type": "n2-standard-8",
            "metadata": {
              "domain": "example.com",
              "sysprep-specialize-script-ps1": "\u003c#**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *#\u003e\n\n### DOMAIN CONTROLLER CONFIGURATION SCRIPT ### \n\n#Generate Stage 1 Script\n'\n$ErrorActionPreference = \"Stop\"\n\n#Add Bootstrapping Metadata to GCE Instance Metadata\ngcloud compute instances add-metadata dc1 --zone=us-central1-f --metadata=STATUS=BOOTSTRAPPING\n\n#Disable Scheduled Task for Stage 1\nDisable-ScheduledTask -TaskName \"Domain Controller Bootstrap - Stage 1\"\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata dc1 --zone=us-central1-f --metadata=STATUS=INSTALLING_ADDS_ROLE\n\n#Install required Windows features\nInstall-WindowsFeature AD-Domain-Services -IncludeManagementTools\n\n#Install Chrome\nStart-BitsTransfer -Source \"https://dl.google.com/chrome/install/latest/chrome_installer.exe\" -Destination \"C:\\chrome_installer.exe\"\nStart-Process \"C:\\chrome_installer.exe\" -ArgumentList \"/silent /install\" -Wait\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata dc1 --zone=us-central1-f --metadata=STATUS=SETTING_PASSWORDS\n\n$local_admin_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=local-admin) -AsPlainText -Force\nGet-LocalUser -Name \"Administrator\" | Set-LocalUser -Password $local_admin_password\nGet-LocalUser -Name \"Administrator\" | Enable-LocalUser\n\n#Get DSRM Password\n$adds_dsrm_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=example-com-dsrm) -AsPlainText -Force\n\n#Enable Scheduled Task for Stage 2\nEnable-ScheduledTask -TaskName \"Domain Controller Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 1\nUnregister-ScheduledTask -TaskName \"Domain Controller Bootstrap - Stage 1\" -Confirm:$false\n\n#Add Admin credentials to Secret Manager\n$ad_admin_user = \"administrator\"\n$ad_admin_password = (gcloud secrets versions access latest --secret=local-admin)\n$ad_admin_cred = (\"Admin Username: \"+ \"example.com\" + \"\\\" + $ad_admin_user + \" `nAdmin Password: \" + $ad_admin_password)\n$ad_admin_cred | gcloud secrets versions add example-com-admin --data-file=-\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata dc1 --zone=us-central1-f --metadata=STATUS=INSTALLING_DOMAIN\n\n#Install Domain\nInstall-ADDSForest `\n-CreateDnsDelegation:$false `\n-DatabasePath \"C:\\Windows\\NTDS\" `\n-DomainMode \"WinThreshold\" `\n-DomainName \"example.com\" `\n-DomainNetbiosName \"example\" `\n-ForestMode \"WinThreshold\" `\n-InstallDns:$true `\n-LogPath \"C:\\Windows\\NTDS\" `\n-NoRebootOnCompletion:$false `\n-SysvolPath \"C:\\Windows\\SYSVOL\" `\n-SafeModeAdministratorPassword $adds_dsrm_password `\n-Force:$true\n\n' | Out-File C:\\stage1.ps1\n\n#Generate Stage 2 Script\n'\n$ErrorActionPreference = \"SilentlyContinue\"\n\n#Disable Scheduled Task for Stage 2\nDisable-ScheduledTask -TaskName \"Domain Controller Bootstrap - Stage 2\"\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata dc1 --zone=us-central1-f --metadata=STATUS=CREATING_AD_OU\n\n#Wait for Domain Services to finish loading\nStart-Sleep (60)\n\n#Get Domain Information\n$Domain = (Get-ADDomain).DNSRoot\n$BaseDN = (Get-ADDomain).DistinguishedName\n\n#Create OU Structure\nNew-ADOrganizationalUnit -Name \"Google Cloud\" -Path $BaseDN -ProtectedFromAccidentalDeletion $False\n$GCPDN = (Get-ADOrganizationalUnit -Filter ''Name -eq \"Google Cloud\"'').DistinguishedName\nNew-ADOrganizationalUnit -Name \"Users\" -Path $GCPDN -ProtectedFromAccidentalDeletion $False\nNew-ADOrganizationalUnit -Name \"Groups\" -Path $GCPDN -ProtectedFromAccidentalDeletion $False\nNew-ADOrganizationalUnit -Name \"Service Accounts\" -Path $GCPDN -ProtectedFromAccidentalDeletion $False\n\n#Create Service Accounts\n$ServiceAccountsDN = (Get-ADOrganizationalUnit -Filter ''Name -eq \"Service Accounts\"'' -SearchBase $GCPDN).DistinguishedName\n$SQLServiceAccountPassword = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=sql-service) -AsPlainText -Force\n$WebServiceAccountPassword = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=web-service) -AsPlainText -Force\nNew-ADUser -Name \"sql-svc\" -Description \"SQL Server Service Account\" -Path $ServiceAccountsDN -AccountPassword $SQLServiceAccountPassword -Enabled $true -PasswordNeverExpires $true\nNew-ADUser -Name \"web-user\" -Description \"Web Server Service Account\" -Path $ServiceAccountsDN -AccountPassword $WebServiceAccountPassword -Enabled $true -PasswordNeverExpires $true\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata dc1 --zone=us-central1-f --metadata=STATUS=READY\n\n#Unregister Scheduled Task for Stage 2\nUnregister-ScheduledTask -TaskName \"Domain Controller Bootstrap - Stage 2\" -Confirm:$false\n\n' | Out-File C:\\stage2.ps1\n\n$stage1_taskName = \"Domain Controller Bootstrap - Stage 1\"\n$s1action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage1.ps1\"\n$s1trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s1principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s1action -Trigger $s1trigger -Principal $s1principal -TaskName $stage1_taskName\n\n$stage2_taskName = \"Domain Controller Bootstrap - Stage 2\"\n$s2action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage2.ps1\"\n$s2trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s2principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s2action -Trigger $s2trigger -Principal $s2principal -TaskName $stage2_taskName\nDisable-ScheduledTask -TaskName \"Domain Controller Bootstrap - Stage 2\"\n\n#Disable Server Manager Startup\nGet-ScheduledTask -TaskName \"ServerManager\" | Disable-ScheduledTask"
            },
            "metadata_fingerprint": "UMrPiuc1C9k=",
            "metadata_startup_script": null,
            "min_cpu_platform": "",
            "name": "dc1",
            "network_interface": [
              {
                "access_config": [],
                "alias_ip_range": [],
                "internal_ipv6_prefix_length": 0,
                "ipv6_access_config": [],
                "ipv6_access_type": "",
                "ipv6_address": "",
                "name": "nic0",
                "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
                "network_ip": "10.145.0.3",
                "nic_type": "",
                "queue_count": 0,
                "stack_type": "IPV4_ONLY",
                "subnetwork": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
                "subnetwork_project": "sql-test-002-414415"
              }
            ],
            "network_performance_config": [],
            "params": [],
            "project": "sql-test-002-414415",
            "reservation_affinity": [],
            "resource_policies": null,
            "scheduling": [
              {
                "automatic_restart": true,
                "instance_termination_action": "",
                "local_ssd_recovery_timeout": [],
                "min_node_cpus": 0,
                "node_affinities": [],
                "on_host_maintenance": "MIGRATE",
                "preemptible": false,
                "provisioning_model": "STANDARD"
              }
            ],
            "scratch_disk": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/instances/dc1",
            "service_account": [
              {
                "email": "prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
                "scopes": [
                  "https://www.googleapis.com/auth/cloud-platform"
                ]
              }
            ],
            "shielded_instance_config": [
              {
                "enable_integrity_monitoring": true,
                "enable_secure_boot": true,
                "enable_vtpm": true
              }
            ],
            "tags": [
              "dc",
              "rdp"
            ],
            "tags_fingerprint": "Smy53THuJv0=",
            "timeouts": null,
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance",
      "name": "jumpbox",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 6,
          "attributes": {
            "advanced_machine_features": [],
            "allow_stopping_for_update": true,
            "attached_disk": [],
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "jumpbox",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "initialize_params": [
                  {
                    "image": "https://www.googleapis.com/compute/v1/projects/windows-cloud/global/images/windows-server-2022-dc-v20240214",
                    "labels": {},
                    "resource_manager_tags": null,
                    "size": 50,
                    "type": "pd-balanced"
                  }
                ],
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/disks/jumpbox"
              }
            ],
            "can_ip_forward": false,
            "confidential_instance_config": [],
            "cpu_platform": "Intel Broadwell",
            "current_status": "RUNNING",
            "deletion_protection": false,
            "description": "",
            "desired_status": null,
            "enable_display": false,
            "guest_accelerator": [],
            "hostname": "",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/jumpbox",
            "instance_id": "1178515711788814700",
            "label_fingerprint": "42WmSpB8rSM=",
            "labels": null,
            "machine_type": "e2-standard-2",
            "metadata": {
              "sysprep-specialize-script-ps1": "\u003c#**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *#\u003e\n\n### JUMPBOX SERVER CONFIGURATION SCRIPT ### \n\n#Generate Stage 1 Script\n'\n$ErrorActionPreference = \"Stop\"\n\n#Wait for OS to initialize\nStart-Sleep (60)\n\n#Add Bootstrapping Metadata to GCE Instance Metadata\ngcloud compute instances add-metadata jumpbox --zone=us-central1-f --metadata=STATUS=BOOTSTRAPPING\n\n#Disable Scheduled Task for Stage 1\nDisable-ScheduledTask -TaskName \"Jumpbox Server Bootstrap - Stage 1\"\n\n#Install Chrome\nStart-BitsTransfer -Source \"https://dl.google.com/chrome/install/latest/chrome_installer.exe\" -Destination \"C:\\chrome_installer.exe\"\nStart-Process \"C:\\chrome_installer.exe\" -ArgumentList \"/silent /install\" -Wait\n\n#Enable Local Administrator\n$local_admin_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=local-admin) -AsPlainText -Force\nGet-LocalUser -Name \"Administrator\" | Set-LocalUser -Password $local_admin_password\nGet-LocalUser -Name \"Administrator\" | Enable-LocalUser\n\n#Enable Scheduled Task for Stage 2\nEnable-ScheduledTask -TaskName \"Jumpbox Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 1\nUnregister-ScheduledTask -TaskName \"Jumpbox Server Bootstrap - Stage 1\" -Confirm:$false\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata jumpbox --zone=us-central1-f --metadata=STATUS=DOMAIN_READY_CHECK\n\n#Check if Domain Controller is ready and add this Server to Domain\n$DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\nwhile($DomainStatus -ne \"READY\")\n    {\n        Start-Sleep(5)\n        $DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\n    }\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata jumpbox --zone=us-central1-f --metadata=STATUS=JOINING_DOMAIN\n\n$ad_admin_user = \"administrator\"\n$ad_admin_username = \"example\" + \"\\\" + $ad_admin_user\n$domain_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $ad_admin_username, $local_admin_password\nAdd-Computer -Domain example.com -Credential $domain_credential -Restart -Force\n\n' | Out-File C:\\stage1.ps1\n\n#Generate Stage 2 Script\n'\n#$ErrorActionPreference = \"SilentlyContinue\"\n\n#Disable Scheduled Task for Stage 2\nDisable-ScheduledTask -TaskName \"Jumpbox Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 2\n#Unregister-ScheduledTask -TaskName \"Jumpbox Server Bootstrap - Stage 2\" -Confirm:$false\n\n#Set DNS Suffix and Register DNS Client\nSet-DNSClient -InterfaceAlias \"Ethernet\" -ConnectionSpecificSuffix \"example.com\"\nRegister-DnsClient\n\n#Clean up files on Public Desktop\nGet-ChildItem -Path C:\\Users\\Public\\Desktop | Where-Object {$_.Extension -notin \".rdp\", \".txt\"} | Remove-Item\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata jumpbox --zone=us-central1-f --metadata=STATUS=READY\n\n' | Out-File C:\\stage2.ps1\n\n$stage1_taskName = \"Jumpbox Server Bootstrap - Stage 1\"\n$s1action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage1.ps1\"\n$s1trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s1principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s1action -Trigger $s1trigger -Principal $s1principal -TaskName $stage1_taskName\n\n$stage2_taskName = \"Jumpbox Server Bootstrap - Stage 2\"\n$s2action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage2.ps1\"\n$s2trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s2principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s2action -Trigger $s2trigger -Principal $s2principal -TaskName $stage2_taskName\nDisable-ScheduledTask -TaskName \"Jumpbox Server Bootstrap - Stage 2\"\n\n#Disable Server Manager Startup\nGet-ScheduledTask -TaskName \"ServerManager\" | Disable-ScheduledTask\n\n#Generate RDP File for dc1\n'\nscreen mode id:i:2\nuse multimon:i:0\ndesktopwidth:i:800\ndesktopheight:i:600\nsession bpp:i:32\nwinposstr:s:0,3,0,0,800,600\ncompression:i:1\nkeyboardhook:i:2\naudiocapturemode:i:0\nvideoplaybackmode:i:1\nconnection type:i:7\nnetworkautodetect:i:1\nbandwidthautodetect:i:1\ndisplayconnectionbar:i:1\nusername:s:example\\administrator\nenableworkspacereconnect:i:0\ndisable wallpaper:i:0\nallow font smoothing:i:0\nallow desktop composition:i:0\ndisable full window drag:i:1\ndisable menu anims:i:1\ndisable themes:i:0\ndisable cursor setting:i:0\nbitmapcachepersistenable:i:1\nfull address:s:dc1\naudiomode:i:0\nredirectprinters:i:1\nredirectcomports:i:0\nredirectsmartcards:i:1\nredirectwebauthn:i:1\nredirectclipboard:i:1\nredirectposdevices:i:0\nautoreconnection enabled:i:1\nauthentication level:i:2\nprompt for credentials:i:0\nnegotiate security layer:i:1\nremoteapplicationmode:i:0\nalternate shell:s:\nshell working directory:s:\ngatewayhostname:s:\ngatewayusagemethod:i:4\ngatewaycredentialssource:i:4\ngatewayprofileusagemethod:i:0\npromptcredentialonce:i:0\ngatewaybrokeringtype:i:0\nuse redirection server name:i:0\nrdgiskdcproxy:i:0\nkdcproxyname:s:\nenablerdsaadauth:i:0\n' | Out-File C:\\Users\\Public\\Desktop\\dc1.rdp \n\n#Generate RDP File for SQL1\n'\nscreen mode id:i:2\nuse multimon:i:0\ndesktopwidth:i:800\ndesktopheight:i:600\nsession bpp:i:32\nwinposstr:s:0,3,0,0,800,600\ncompression:i:1\nkeyboardhook:i:2\naudiocapturemode:i:0\nvideoplaybackmode:i:1\nconnection type:i:7\nnetworkautodetect:i:1\nbandwidthautodetect:i:1\ndisplayconnectionbar:i:1\nusername:s:example\\administrator\nenableworkspacereconnect:i:0\ndisable wallpaper:i:0\nallow font smoothing:i:0\nallow desktop composition:i:0\ndisable full window drag:i:1\ndisable menu anims:i:1\ndisable themes:i:0\ndisable cursor setting:i:0\nbitmapcachepersistenable:i:1\nfull address:s:sql1\naudiomode:i:0\nredirectprinters:i:1\nredirectcomports:i:0\nredirectsmartcards:i:1\nredirectwebauthn:i:1\nredirectclipboard:i:1\nredirectposdevices:i:0\nautoreconnection enabled:i:1\nauthentication level:i:2\nprompt for credentials:i:0\nnegotiate security layer:i:1\nremoteapplicationmode:i:0\nalternate shell:s:\nshell working directory:s:\ngatewayhostname:s:\ngatewayusagemethod:i:4\ngatewaycredentialssource:i:4\ngatewayprofileusagemethod:i:0\npromptcredentialonce:i:0\ngatewaybrokeringtype:i:0\nuse redirection server name:i:0\nrdgiskdcproxy:i:0\nkdcproxyname:s:\nenablerdsaadauth:i:0\n' | Out-File C:\\Users\\Public\\Desktop\\sql1.rdp\n\n#Generate RDP File for SQL2\n'\nscreen mode id:i:2\nuse multimon:i:0\ndesktopwidth:i:800\ndesktopheight:i:600\nsession bpp:i:32\nwinposstr:s:0,3,0,0,800,600\ncompression:i:1\nkeyboardhook:i:2\naudiocapturemode:i:0\nvideoplaybackmode:i:1\nconnection type:i:7\nnetworkautodetect:i:1\nbandwidthautodetect:i:1\ndisplayconnectionbar:i:1\nusername:s:example\\administrator\nenableworkspacereconnect:i:0\ndisable wallpaper:i:0\nallow font smoothing:i:0\nallow desktop composition:i:0\ndisable full window drag:i:1\ndisable menu anims:i:1\ndisable themes:i:0\ndisable cursor setting:i:0\nbitmapcachepersistenable:i:1\nfull address:s:sql2\naudiomode:i:0\nredirectprinters:i:1\nredirectcomports:i:0\nredirectsmartcards:i:1\nredirectwebauthn:i:1\nredirectclipboard:i:1\nredirectposdevices:i:0\nautoreconnection enabled:i:1\nauthentication level:i:2\nprompt for credentials:i:0\nnegotiate security layer:i:1\nremoteapplicationmode:i:0\nalternate shell:s:\nshell working directory:s:\ngatewayhostname:s:\ngatewayusagemethod:i:4\ngatewaycredentialssource:i:4\ngatewayprofileusagemethod:i:0\npromptcredentialonce:i:0\ngatewaybrokeringtype:i:0\nuse redirection server name:i:0\nrdgiskdcproxy:i:0\nkdcproxyname:s:\nenablerdsaadauth:i:0\n' | Out-File C:\\Users\\Public\\Desktop\\sql2.rdp\n\n#Generate RDP File for Web1\n'\nscreen mode id:i:2\nuse multimon:i:0\ndesktopwidth:i:800\ndesktopheight:i:600\nsession bpp:i:32\nwinposstr:s:0,3,0,0,800,600\ncompression:i:1\nkeyboardhook:i:2\naudiocapturemode:i:0\nvideoplaybackmode:i:1\nconnection type:i:7\nnetworkautodetect:i:1\nbandwidthautodetect:i:1\ndisplayconnectionbar:i:1\nusername:s:example\\administrator\nenableworkspacereconnect:i:0\ndisable wallpaper:i:0\nallow font smoothing:i:0\nallow desktop composition:i:0\ndisable full window drag:i:1\ndisable menu anims:i:1\ndisable themes:i:0\ndisable cursor setting:i:0\nbitmapcachepersistenable:i:1\nfull address:s:web1\naudiomode:i:0\nredirectprinters:i:1\nredirectcomports:i:0\nredirectsmartcards:i:1\nredirectwebauthn:i:1\nredirectclipboard:i:1\nredirectposdevices:i:0\nautoreconnection enabled:i:1\nauthentication level:i:2\nprompt for credentials:i:0\nnegotiate security layer:i:1\nremoteapplicationmode:i:0\nalternate shell:s:\nshell working directory:s:\ngatewayhostname:s:\ngatewayusagemethod:i:4\ngatewaycredentialssource:i:4\ngatewayprofileusagemethod:i:0\npromptcredentialonce:i:0\ngatewaybrokeringtype:i:0\nuse redirection server name:i:0\nrdgiskdcproxy:i:0\nkdcproxyname:s:\nenablerdsaadauth:i:0\n' | Out-File C:\\Users\\Public\\Desktop\\web1.rdp\n\n#Generate RDP File for Witness\n'\nscreen mode id:i:2\nuse multimon:i:0\ndesktopwidth:i:800\ndesktopheight:i:600\nsession bpp:i:32\nwinposstr:s:0,3,0,0,800,600\ncompression:i:1\nkeyboardhook:i:2\naudiocapturemode:i:0\nvideoplaybackmode:i:1\nconnection type:i:7\nnetworkautodetect:i:1\nbandwidthautodetect:i:1\ndisplayconnectionbar:i:1\nusername:s:example\\administrator\nenableworkspacereconnect:i:0\ndisable wallpaper:i:0\nallow font smoothing:i:0\nallow desktop composition:i:0\ndisable full window drag:i:1\ndisable menu anims:i:1\ndisable themes:i:0\ndisable cursor setting:i:0\nbitmapcachepersistenable:i:1\nfull address:s:witness\naudiomode:i:0\nredirectprinters:i:1\nredirectcomports:i:0\nredirectsmartcards:i:1\nredirectwebauthn:i:1\nredirectclipboard:i:1\nredirectposdevices:i:0\nautoreconnection enabled:i:1\nauthentication level:i:2\nprompt for credentials:i:0\nnegotiate security layer:i:1\nremoteapplicationmode:i:0\nalternate shell:s:\nshell working directory:s:\ngatewayhostname:s:\ngatewayusagemethod:i:4\ngatewaycredentialssource:i:4\ngatewayprofileusagemethod:i:0\npromptcredentialonce:i:0\ngatewaybrokeringtype:i:0\nuse redirection server name:i:0\nrdgiskdcproxy:i:0\nkdcproxyname:s:\nenablerdsaadauth:i:0\n' | Out-File C:\\Users\\Public\\Desktop\\witness.rdp\n\n#Generate instructions to retrieve passwords\n'\n###############################\n###  C R E D E N T I A L S  ###\n###############################\n\nAll Servers are already joined to the example.com Domain.\n\nTo access the different Servers do the following:\n\n1. Open the Command Prompt or Powershell\n\n2. Run the following command\n   \u003e gcloud secrets versions access latest --secret=example-com-admin\n\n   Note: The Service Account used to create the Servers are already authorized to access the Secret.\n\n   You can also navigate to Cloud Console \u003e Security \u003e Secrets Manager \u003e example-com-admin\n\n3. Copy the password\n\n4. Double click on the Server RDP file on the Desktop (for example: dc1) and when prompted, supply the password\n' | Out-File \"C:\\Users\\Public\\Desktop\\Readme.txt\"\n"
            },
            "metadata_fingerprint": "web4umcRbrY=",
            "metadata_startup_script": null,
            "min_cpu_platform": "",
            "name": "jumpbox",
            "network_interface": [
              {
                "access_config": [],
                "alias_ip_range": [],
                "internal_ipv6_prefix_length": 0,
                "ipv6_access_config": [],
                "ipv6_access_type": "",
                "ipv6_address": "",
                "name": "nic0",
                "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
                "network_ip": "10.145.0.8",
                "nic_type": "",
                "queue_count": 0,
                "stack_type": "IPV4_ONLY",
                "subnetwork": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
                "subnetwork_project": "sql-test-002-414415"
              }
            ],
            "network_performance_config": [],
            "params": [],
            "project": "sql-test-002-414415",
            "reservation_affinity": [],
            "resource_policies": null,
            "scheduling": [
              {
                "automatic_restart": true,
                "instance_termination_action": "",
                "local_ssd_recovery_timeout": [],
                "min_node_cpus": 0,
                "node_affinities": [],
                "on_host_maintenance": "MIGRATE",
                "preemptible": false,
                "provisioning_model": "STANDARD"
              }
            ],
            "scratch_disk": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/instances/jumpbox",
            "service_account": [
              {
                "email": "prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
                "scopes": [
                  "https://www.googleapis.com/auth/cloud-platform"
                ]
              }
            ],
            "shielded_instance_config": [
              {
                "enable_integrity_monitoring": true,
                "enable_secure_boot": true,
                "enable_vtpm": true
              }
            ],
            "tags": [
              "jumpbox",
              "rdp"
            ],
            "tags_fingerprint": "KRkrTranogM=",
            "timeouts": null,
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9",
          "dependencies": [
            "google_compute_instance.dc1",
            "google_compute_instance.sql2",
            "google_compute_instance.witness",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance",
      "name": "sql1",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 6,
          "attributes": {
            "advanced_machine_features": [],
            "allow_stopping_for_update": true,
            "attached_disk": [],
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "sql1",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "initialize_params": [
                  {
                    "image": "https://www.googleapis.com/compute/v1/projects/windows-sql-cloud/global/images/sql-2022-standard-windows-2022-dc-v20240214",
                    "labels": {},
                    "resource_manager_tags": null,
                    "size": 50,
                    "type": "pd-balanced"
                  }
                ],
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/disks/sql1"
              }
            ],
            "can_ip_forward": false,
            "confidential_instance_config": [],
            "cpu_platform": "Intel Cascade Lake",
            "current_status": "RUNNING",
            "deletion_protection": false,
            "description": "",
            "desired_status": null,
            "enable_display": false,
            "guest_accelerator": [],
            "hostname": "",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql1",
            "instance_id": "3047088938115371439",
            "label_fingerprint": "42WmSpB8rSM=",
            "labels": null,
            "machine_type": "n2-standard-4",
            "metadata": {
              "sysprep-specialize-script-ps1": "\u003c#**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *#\u003e\n\n### SQL SERVER CONFIGURATION SCRIPT ### \n\n#Generate Stage 1 Script\n'\n$ErrorActionPreference = \"Stop\"\n\n#Wait for OS to initialize\nStart-Sleep (60)\n\n#Add Bootstrapping Metadata to GCE Instance Metadata\ngcloud compute instances add-metadata sql1 --zone=us-central1-f --metadata=STATUS=BOOTSTRAPPING\n\n#Disable Scheduled Task for Stage 1\nDisable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 1\"\n\n# Install required Windows features\nInstall-WindowsFeature Failover-Clustering -IncludeManagementTools\nInstall-WindowsFeature RSAT-AD-PowerShell\n\n#Open Windows Firewall Ports for SQL Server AlwaysOn\nnetsh advfirewall firewall add rule name=\"Allow SQL Server\" dir=in action=allow protocol=TCP localport=1433\nnetsh advfirewall firewall add rule name=\"Allow SQL Server replication\" dir=in action=allow protocol=TCP localport=5022\nnetsh advfirewall firewall add rule name=\"Allow SQL Server DNN Listener\" dir=in action=allow protocol=TCP localport=6789\n\n#Install Chrome\nStart-BitsTransfer -Source \"https://dl.google.com/chrome/install/latest/chrome_installer.exe\" -Destination \"C:\\chrome_installer.exe\"\nStart-Process \"C:\\chrome_installer.exe\" -ArgumentList \"/silent /install\" -Wait\n\n#Enable Local Administrator\n$local_admin_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=local-admin) -AsPlainText -Force\nGet-LocalUser -Name \"Administrator\" | Set-LocalUser -Password $local_admin_password\nGet-LocalUser -Name \"Administrator\" | Enable-LocalUser\n\n#Enable Scheduled Task for Stage 2 Skycrane\nEnable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2 Skycrane\"\n\n#Unregister Scheduled Task for Stage 1\nUnregister-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 1\" -Confirm:$false\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata sql1 --zone=us-central1-f --metadata=STATUS=DOMAIN_READY_CHECK\n\n#Check if Domain Controller is ready and add this Server to Domain\n$DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\nwhile($DomainStatus -ne \"READY\")\n    {\n        Start-Sleep(5)\n        $DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\n    }\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata sql1 --zone=us-central1-f --metadata=STATUS=JOINING_DOMAIN\n\n$ad_admin_user = \"administrator\"\n$ad_admin_username = \"example\" + \"\\\" + $ad_admin_user\n$domain_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $ad_admin_username, $local_admin_password\n\nAdd-Computer -Domain example.com -Credential $domain_credential -Restart -Force\n\n' | Out-File C:\\stage1.ps1\n\n#Generate Stage 2 Script Skycrane\n'\n$ErrorActionPreference = \"SilentlyContinue\"\n\n#Disable Scheduled Task for Stage 2 Skycrane\nDisable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2 Skycrane\"\n\n#Unregister Scheduled Task for Stage 2 Skycrane\nUnregister-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2 Skycrane\" -Confirm:$false\n\n#Get Domain Credentials\n$local_admin_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=local-admin) -AsPlainText -Force\n$ad_admin_user = \"administrator\"\n$ad_admin_username = \"example\" + \"\\\" + $ad_admin_user\n$domain_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $ad_admin_username, $local_admin_password\n$secure_domain_password = $domain_credential.GetNetworkCredential().Password\n\n#Register Scheduled Task with Domain Credentials\n$stage2_taskName = \"SQL Server Bootstrap - Stage 2\"\n$s2action = New-ScheduledTaskAction -Execute \"PowerShell.exe\" -Argument \"C:\\stage2.ps1\"\n$s2trigger = New-ScheduledTaskTrigger -AtStartup\nRegister-ScheduledTask -Action $s2action -Trigger $s2trigger -TaskName $stage2_taskName -User $ad_admin_username -Password $secure_domain_password\nStart-ScheduledTask -TaskName $stage2_taskName\n' | Out-File C:\\stage2skycrane.ps1\n\n#Generate Stage 2 Script\n'\n$ErrorActionPreference = \"SilentlyContinue\"\n\n#Wait for OS to initialize\nStart-Sleep (60)\n\n#Disable Scheduled Task for Stage 2\nDisable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 2\nUnregister-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2\" -Confirm:$false\n\n#Set DNS Suffix and Register DNS Client\nSet-DNSClient -InterfaceAlias \"Ethernet\" -ConnectionSpecificSuffix \"example.com\"\nRegister-DnsClient\n\n#Change SQL Server Service Logon Account\npwsh C:\\sqlsvc.ps1\n\n#Rename SQL Server Instance\n$renameinstance = \"EXEC sp_dropserver @server=@@SERVERNAME;\nGO\nEXEC sp_addserver ''sql1'', local;\nGO\"\nsqlcmd -Q $renameinstance\nRestart-Service -Name MSSQLSERVER\n\n#Add SQL Server Service Account to Local Administrators\nAdd-LocalGroupMember -Group \"Administrators\" -Member \"example\\sql-svc\"\n\n#Create WSFC Cluster\n$sql2Check = Test-NetConnection sql2 -Port 1433\n$quorumCheck = Get-SMBShare -CIMSession \"witness\" -Name \"QWitness\"\n$Error \u003e C:\\error.txt \n\nwhile (($sql2Check -eq \"Failure\") -and !$quorumCheck) {\n  Start-Sleep (5)\n  $sql2Check = Test-NetConnection sql2 -Port 1433\n  $quorumCheck = Get-SMBShare -CIMSession \"witness\" -Name \"QWitness\"\n}\n\nNew-Cluster -Name sql-cluster -Node sql1,sql2 -NoStorage -StaticAddress 10.145.0.2\n$Error \u003e\u003e C:\\error.txt\n\nSet-ClusterQuorum -FileShareWitness \\\\witness\\QWitness\n\nEnable-SqlAlwaysOn -ServerInstance sql1 -Force\nEnable-SqlAlwaysOn -ServerInstance sql2 -Force\n\n#Download Sample Database\n#Start-BitsTransfer -Source \"https://docs.google.com/uc?export=download\u0026id=1jh8gm2raP2T5KI6SR5q2wXyR8PZfXv5C\" -Destination \"C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\Backup\\ContosoUniversity.bak\"\nInvoke-WebRequest -Uri \"https://docs.google.com/uc?export=download\u0026id=1jh8gm2raP2T5KI6SR5q2wXyR8PZfXv5C\" -Outfile \"C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\Backup\\ContosoUniversity.bak\"\n\n#Restore Database and prepare for AlwaysOn Availability Group\n$restoredb = \"USE [master];\nRESTORE DATABASE [ContosoUniversity] FROM  DISK = N''C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\Backup\\ContosoUniversity.bak'' WITH  FILE = 1,  NOUNLOAD,  STATS = 5;\nGO\nALTER DATABASE [bookshelf] SET RECOVERY FULL;\nGO\nBACKUP DATABASE bookshelf to disk = ''C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\Backup\\CU.bak'' WITH INIT;\nGO\"\nsqlcmd -Q $restoredb\n\n#Build AlwaysOn Availability Group without Listener\n$buildag = \":Connect sql1\nCREATE ENDPOINT [Hadr_endpoint]\n\tSTATE=STARTED\n\tAS TCP (LISTENER_PORT=5022)\n\tFOR DATABASE_MIRRORING (ROLE=ALL, ENCRYPTION = REQUIRED ALGORITHM AES)\nGO\n\n:Connect sql2\nCREATE ENDPOINT [Hadr_endpoint]\n\tSTATE=STARTED\n\tAS TCP (LISTENER_PORT=5022)\n\tFOR DATABASE_MIRRORING (ROLE=ALL, ENCRYPTION = REQUIRED ALGORITHM AES)\nGO\n\n:Connect sql1\nIF (SELECT state FROM sys.endpoints WHERE name = N''Hadr_endpoint'') \u003c\u003e 0\nBEGIN\n\tALTER ENDPOINT [Hadr_endpoint] STATE = STARTED\nEND\nGO\n\nuse [master]\nGO\n\nGRANT CONNECT ON ENDPOINT::[Hadr_endpoint] TO [example\\sql-svc]\nGO\n\n:Connect sql1\nIF EXISTS(SELECT * FROM sys.server_event_sessions WHERE name=''AlwaysOn_health'')\nBEGIN\n  ALTER EVENT SESSION [AlwaysOn_health] ON SERVER WITH (STARTUP_STATE=ON);\nEND\nIF NOT EXISTS(SELECT * FROM sys.dm_xe_sessions WHERE name=''AlwaysOn_health'')\nBEGIN\n  ALTER EVENT SESSION [AlwaysOn_health] ON SERVER STATE=START;\nEND\nGO\n\n:Connect sql2\nIF (SELECT state FROM sys.endpoints WHERE name = N''Hadr_endpoint'') \u003c\u003e 0\nBEGIN\n\tALTER ENDPOINT [Hadr_endpoint] STATE = STARTED\nEND\nGO\n\nuse [master]\nGO\nGRANT CONNECT ON ENDPOINT::[Hadr_endpoint] TO [example\\sql-svc]\nGO\n\n:Connect sql2\nIF EXISTS(SELECT * FROM sys.server_event_sessions WHERE name=''AlwaysOn_health'')\nBEGIN\n  ALTER EVENT SESSION [AlwaysOn_health] ON SERVER WITH (STARTUP_STATE=ON);\nEND\nIF NOT EXISTS(SELECT * FROM sys.dm_xe_sessions WHERE name=''AlwaysOn_health'')\nBEGIN\n  ALTER EVENT SESSION [AlwaysOn_health] ON SERVER STATE=START;\nEND\nGO\n\n:Connect sql1\nUSE [master]\nGO\n\nCREATE AVAILABILITY GROUP [aoag-dnn]\nWITH (AUTOMATED_BACKUP_PREFERENCE = PRIMARY,\nBASIC,\nDB_FAILOVER = OFF,\nDTC_SUPPORT = NONE,\nREQUIRED_SYNCHRONIZED_SECONDARIES_TO_COMMIT = 0)\nFOR DATABASE [ContosoUniversity]\nREPLICA ON N''sql1'' WITH (ENDPOINT_URL = N''TCP://sql1.example.com:5022'', FAILOVER_MODE = MANUAL, AVAILABILITY_MODE = SYNCHRONOUS_COMMIT, SEEDING_MODE = MANUAL, SECONDARY_ROLE(ALLOW_CONNECTIONS = NO)),\n\tN''sql2'' WITH (ENDPOINT_URL = N''TCP://sql2.example.com:5022'', FAILOVER_MODE = MANUAL, AVAILABILITY_MODE = SYNCHRONOUS_COMMIT, SEEDING_MODE = MANUAL, SECONDARY_ROLE(ALLOW_CONNECTIONS = NO));\n\nGO\n\n:Connect sql2\nALTER AVAILABILITY GROUP [aoag-dnn] JOIN;\nGO\n\n:Connect sql1\nBACKUP DATABASE [ContosoUniversity] TO  DISK = N''\\\\witness\\backup\\ContosoUniversity.bak'' WITH  COPY_ONLY, FORMAT, INIT, SKIP, REWIND, NOUNLOAD, COMPRESSION,  STATS = 5\nGO\n\n:Connect sql2\nRESTORE DATABASE [ContosoUniversity] FROM  DISK = N''\\\\witness\\backup\\ContosoUniversity.bak'' WITH  NORECOVERY,  NOUNLOAD,  STATS = 5\nGO\n\n:Connect sql1\nBACKUP LOG [ContosoUniversity] TO  DISK = N''\\\\witness\\backup\\ContosoUniversity.trn'' WITH NOFORMAT, INIT, NOSKIP, REWIND, NOUNLOAD, COMPRESSION,  STATS = 5\nGO\n\n:Connect sql2\nRESTORE LOG [ContosoUniversity] FROM  DISK = N''\\\\witness\\backup\\ContosoUniversity.trn'' WITH  NORECOVERY,  NOUNLOAD,  STATS = 5\nGO\n\n:Connect sql2\n-- Wait for the replica to start communicating\nbegin try\ndeclare @conn bit\ndeclare @count int\ndeclare @replica_id uniqueidentifier \ndeclare @group_id uniqueidentifier\nset @conn = 0\nset @count = 30 -- wait for 5 minutes \n\nif (serverproperty(''IsHadrEnabled'') = 1)\n\tand (isnull((select member_state from master.sys.dm_hadr_cluster_members where upper(member_name COLLATE Latin1_General_CI_AS) = upper(cast(serverproperty(''ComputerNamePhysicalNetBIOS'') as nvarchar(256)) COLLATE Latin1_General_CI_AS)), 0) \u003c\u003e 0)\n\tand (isnull((select state from master.sys.database_mirroring_endpoints), 1) = 0)\nbegin\n    select @group_id = ags.group_id from master.sys.availability_groups as ags where name = N''aoag-dnn''\n\tselect @replica_id = replicas.replica_id from master.sys.availability_replicas as replicas where upper(replicas.replica_server_name COLLATE Latin1_General_CI_AS) = upper(@@SERVERNAME COLLATE Latin1_General_CI_AS) and group_id = @group_id\n\twhile @conn \u003c\u003e 1 and @count \u003e 0\n\tbegin\n\t\tset @conn = isnull((select connected_state from master.sys.dm_hadr_availability_replica_states as states where states.replica_id = @replica_id), 1)\n\t\tif @conn = 1\n\t\tbegin\n\t\t\t-- exit loop when the replica is connected, or if the query cannot find the replica status\n\t\t\tbreak\n\t\tend\n\t\twaitfor delay ''00:00:10''\n\t\tset @count = @count - 1\n\tend\nend\nend try\nbegin catch\n\t-- If the wait loop fails, do not stop execution of the alter database statement\nend catch\nALTER DATABASE [ContosoUniversity] SET HADR AVAILABILITY GROUP = [aoag-dnn];\nGO\nGO\"\n\nsqlcmd -Q $buildag\n\n#Add Web Service User to SQL Instances and AG Database\n$addwebsvc = \":Connect sql1\nUSE [master]\nGO\nCREATE LOGIN [example\\web-user] FROM WINDOWS WITH DEFAULT_DATABASE=[ContosoUniversity]\nGO\nUSE [ContosoUniversity]\nGO\nCREATE USER [example\\web-user] FOR LOGIN [example\\web-user]\nGO\nUSE [ContosoUniversity]\nGO\nALTER ROLE [db_owner] ADD MEMBER [example\\web-user]\nGO\n\n:Connect sql2\nUSE [master]\nGO\nCREATE LOGIN [example\\web-user] FROM WINDOWS WITH DEFAULT_DATABASE=[ContosoUniversity]\nGO\"\n\nsqlcmd -Q $addwebsvc\n\nC:\\add_dnn_listener.ps1 aoag-dnn dnn-listener 6789\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata sql1 --zone=us-central1-f --metadata=STATUS=READY\n\n' | Out-File C:\\stage2.ps1\n\n'\n$sql_username = \"example\\sql-svc\"\n$sql_user_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=sql-service) -AsPlainText -Force\n$sql_user_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $sql_username, $sql_user_password\nSet-Service -Name MSSQLSERVER -Credential $sql_user_credential\nRestart-Service -Name MSSQLSERVER\n' | Out-File C:\\sqlsvc.ps1\n\n'\n#Script Source\n#Link: https://learn.microsoft.com/en-us/azure/azure-sql/virtual-machines/windows/availability-group-distributed-network-name-dnn-listener-configure?view=azuresql\n\nparam (\n   [Parameter(Mandatory=$true)][string]$Ag,\n   [Parameter(Mandatory=$true)][string]$Dns,\n   [Parameter(Mandatory=$true)][string]$Port\n)\n\nWrite-Host \"Add a DNN listener for availability group $Ag with DNS name $Dns and port $Port\"\n\n$ErrorActionPreference = \"Stop\"\n\n# create the DNN resource with the port as the resource name\nAdd-ClusterResource -Name $Port -ResourceType \"Distributed Network Name\" -Group $Ag \n\n# set the DNS name of the DNN resource\nGet-ClusterResource -Name $Port | Set-ClusterParameter -Name DnsName -Value $Dns \n\n# start the DNN resource\nStart-ClusterResource -Name $Port\n\n$Dep = Get-ClusterResourceDependency -Resource $Ag\nif ( $Dep.DependencyExpression -match ''\\s*\\((.*)\\)\\s*'' ) {\n\t$DepStr = \"$($Matches.1) or [$Port]\"\n} else {\n\t$DepStr = \"[$Port]\"\n}\n\nWrite-Host \"$DepStr\"\n\n# add the Dependency from availability group resource to the DNN resource\nSet-ClusterResourceDependency -Resource $Ag -Dependency \"$DepStr\"\n\n#bounce the AG resource\nStop-ClusterResource -Name $Ag\nStart-ClusterResource -Name $Ag\n' | Out-File C:\\add_dnn_listener.ps1\n\n$stage1_taskName = \"SQL Server Bootstrap - Stage 1\"\n$s1action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage1.ps1\"\n$s1trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s1principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s1action -Trigger $s1trigger -Principal $s1principal -TaskName $stage1_taskName\n\n$stage2skycrane_taskName = \"SQL Server Bootstrap - Stage 2 Skycrane\"\n$s2skycraneaction = New-ScheduledTaskAction -Execute 'PowerShell.exe' -Argument \"C:\\stage2skycrane.ps1\"\n$s2skycranetrigger = New-ScheduledTaskTrigger -AtStartup\n\n$s2skycraneprincipal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s2skycraneaction -Trigger $s2skycranetrigger -Principal $s2skycraneprincipal -TaskName $stage2skycrane_taskName\nDisable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2 Skycrane\"\n\n#Disable Server Manager Startup\nGet-ScheduledTask -TaskName \"ServerManager\" | Disable-ScheduledTask"
            },
            "metadata_fingerprint": "2wRAOHnCIl0=",
            "metadata_startup_script": null,
            "min_cpu_platform": "",
            "name": "sql1",
            "network_interface": [
              {
                "access_config": [],
                "alias_ip_range": [],
                "internal_ipv6_prefix_length": 0,
                "ipv6_access_config": [],
                "ipv6_access_type": "",
                "ipv6_address": "",
                "name": "nic0",
                "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
                "network_ip": "10.145.0.6",
                "nic_type": "",
                "queue_count": 0,
                "stack_type": "IPV4_ONLY",
                "subnetwork": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
                "subnetwork_project": "sql-test-002-414415"
              }
            ],
            "network_performance_config": [],
            "params": [],
            "project": "sql-test-002-414415",
            "reservation_affinity": [],
            "resource_policies": null,
            "scheduling": [
              {
                "automatic_restart": true,
                "instance_termination_action": "",
                "local_ssd_recovery_timeout": [],
                "min_node_cpus": 0,
                "node_affinities": [],
                "on_host_maintenance": "MIGRATE",
                "preemptible": false,
                "provisioning_model": "STANDARD"
              }
            ],
            "scratch_disk": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/instances/sql1",
            "service_account": [
              {
                "email": "prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
                "scopes": [
                  "https://www.googleapis.com/auth/cloud-platform"
                ]
              }
            ],
            "shielded_instance_config": [
              {
                "enable_integrity_monitoring": true,
                "enable_secure_boot": true,
                "enable_vtpm": true
              }
            ],
            "tags": [
              "rdp",
              "sql"
            ],
            "tags_fingerprint": "sCC_WLITvTk=",
            "timeouts": null,
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance",
      "name": "sql2",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 6,
          "attributes": {
            "advanced_machine_features": [],
            "allow_stopping_for_update": true,
            "attached_disk": [],
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "sql2",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "initialize_params": [
                  {
                    "image": "https://www.googleapis.com/compute/v1/projects/windows-sql-cloud/global/images/sql-2022-standard-windows-2022-dc-v20240214",
                    "labels": {},
                    "resource_manager_tags": null,
                    "size": 50,
                    "type": "pd-balanced"
                  }
                ],
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/disks/sql2"
              }
            ],
            "can_ip_forward": false,
            "confidential_instance_config": [],
            "cpu_platform": "Intel Cascade Lake",
            "current_status": "RUNNING",
            "deletion_protection": false,
            "description": "",
            "desired_status": null,
            "enable_display": false,
            "guest_accelerator": [],
            "hostname": "",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql2",
            "instance_id": "2189314991929397712",
            "label_fingerprint": "42WmSpB8rSM=",
            "labels": null,
            "machine_type": "n2-standard-4",
            "metadata": {
              "sysprep-specialize-script-ps1": "\u003c#**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *#\u003e\n\n### SQL SERVER CONFIGURATION SCRIPT ### \n\n#Generate Stage 1 Script\n'\n$ErrorActionPreference = \"Stop\"\n\n#Wait for OS to initialize\nStart-Sleep (60)\n\n#Add Bootstrapping Metadata to GCE Instance Metadata\ngcloud compute instances add-metadata sql2 --zone=us-central1-f --metadata=STATUS=BOOTSTRAPPING\n\n#Disable Scheduled Task for Stage 1\nDisable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 1\"\n\n# Install required Windows features\nInstall-WindowsFeature Failover-Clustering -IncludeManagementTools\nInstall-WindowsFeature RSAT-AD-PowerShell\n\n#Open Windows Firewall Ports for SQL Server AlwaysOn\nnetsh advfirewall firewall add rule name=\"Allow SQL Server\" dir=in action=allow protocol=TCP localport=1433\nnetsh advfirewall firewall add rule name=\"Allow SQL Server replication\" dir=in action=allow protocol=TCP localport=5022\nnetsh advfirewall firewall add rule name=\"Allow SQL Server DNN Listener\" dir=in action=allow protocol=TCP localport=6789\n\n#Install Chrome\nStart-BitsTransfer -Source \"https://dl.google.com/chrome/install/latest/chrome_installer.exe\" -Destination \"C:\\chrome_installer.exe\"\nStart-Process \"C:\\chrome_installer.exe\" -ArgumentList \"/silent /install\" -Wait\n\n#Enable Local Administrator\n$local_admin_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=local-admin) -AsPlainText -Force\nGet-LocalUser -Name \"Administrator\" | Set-LocalUser -Password $local_admin_password\nGet-LocalUser -Name \"Administrator\" | Enable-LocalUser\n\n#Enable Scheduled Task for Stage 2\nEnable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 1\nUnregister-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 1\" -Confirm:$false\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata sql2 --zone=us-central1-f --metadata=STATUS=DOMAIN_READY_CHECK\n\n#Check if Domain Controller is ready and add this Server to Domain\n$DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\nwhile($DomainStatus -ne \"READY\")\n    {\n        Start-Sleep(5)\n        $DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\n    }\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata sql2 --zone=us-central1-f --metadata=STATUS=JOINING_DOMAIN\n\n$ad_admin_user = \"administrator\"\n$ad_admin_username = \"example\" + \"\\\" + $ad_admin_user\n$domain_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $ad_admin_username, $local_admin_password\nAdd-Computer -Domain example.com -Credential $domain_credential -Restart -Force\n\n' | Out-File C:\\stage1.ps1\n\n#Generate Stage 2 Script\n'\n#$ErrorActionPreference = \"SilentlyContinue\"\n\n#Wait for OS to initialize\nStart-Sleep (60)\n\n#Disable Scheduled Task for Stage 2\nDisable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 2\n#Unregister-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2\" -Confirm:$false\n\n#Set DNS Suffix and Register DNS Client\nSet-DNSClient -InterfaceAlias \"Ethernet\" -ConnectionSpecificSuffix \"example.com\"\nRegister-DnsClient\n\n#Change SQL Server Service Logon Account\npwsh C:\\sqlsvc.ps1\n\n#Rename SQL Server Instance\n$renameinstance = \"EXEC sp_dropserver @server=@@SERVERNAME;\nGO\nEXEC sp_addserver ''sql2'', local;\nGO\"\nsqlcmd -Q $renameinstance\nRestart-Service -Name MSSQLSERVER\n\n#Add SQL Server Service Account to Local Administrators\nAdd-LocalGroupMember -Group \"Administrators\" -Member \"example\\sql-svc\"\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata sql2 --zone=us-central1-f --metadata=STATUS=READY\n\n' | Out-File C:\\stage2.ps1\n\n$stage1_taskName = \"SQL Server Bootstrap - Stage 1\"\n$s1action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage1.ps1\"\n$s1trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s1principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s1action -Trigger $s1trigger -Principal $s1principal -TaskName $stage1_taskName\n\n$stage2_taskName = \"SQL Server Bootstrap - Stage 2\"\n$s2action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage2.ps1\"\n$s2trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s2principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s2action -Trigger $s2trigger -Principal $s2principal -TaskName $stage2_taskName\nDisable-ScheduledTask -TaskName \"SQL Server Bootstrap - Stage 2\"\n\n#Disable Server Manager Startup\nGet-ScheduledTask -TaskName \"ServerManager\" | Disable-ScheduledTask\n\n'\n$sql_username = \"example\\sql-svc\"\n$sql_user_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=sql-service) -AsPlainText -Force\n$sql_user_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $sql_username, $sql_user_password\nSet-Service -Name MSSQLSERVER -Credential $sql_user_credential\nRestart-Service -Name MSSQLSERVER\n' | Out-File C:\\sqlsvc.ps1"
            },
            "metadata_fingerprint": "l5gUrtDVa5E=",
            "metadata_startup_script": null,
            "min_cpu_platform": "",
            "name": "sql2",
            "network_interface": [
              {
                "access_config": [],
                "alias_ip_range": [],
                "internal_ipv6_prefix_length": 0,
                "ipv6_access_config": [],
                "ipv6_access_type": "",
                "ipv6_address": "",
                "name": "nic0",
                "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
                "network_ip": "10.145.0.5",
                "nic_type": "",
                "queue_count": 0,
                "stack_type": "IPV4_ONLY",
                "subnetwork": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
                "subnetwork_project": "sql-test-002-414415"
              }
            ],
            "network_performance_config": [],
            "params": [],
            "project": "sql-test-002-414415",
            "reservation_affinity": [],
            "resource_policies": null,
            "scheduling": [
              {
                "automatic_restart": true,
                "instance_termination_action": "",
                "local_ssd_recovery_timeout": [],
                "min_node_cpus": 0,
                "node_affinities": [],
                "on_host_maintenance": "MIGRATE",
                "preemptible": false,
                "provisioning_model": "STANDARD"
              }
            ],
            "scratch_disk": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/instances/sql2",
            "service_account": [
              {
                "email": "prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
                "scopes": [
                  "https://www.googleapis.com/auth/cloud-platform"
                ]
              }
            ],
            "shielded_instance_config": [
              {
                "enable_integrity_monitoring": true,
                "enable_secure_boot": true,
                "enable_vtpm": true
              }
            ],
            "tags": [
              "rdp",
              "sql"
            ],
            "tags_fingerprint": "sCC_WLITvTk=",
            "timeouts": null,
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9",
          "dependencies": [
            "google_compute_instance.dc1",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance",
      "name": "web1",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 6,
          "attributes": {
            "advanced_machine_features": [],
            "allow_stopping_for_update": true,
            "attached_disk": [],
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "web1",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "initialize_params": [
                  {
                    "image": "https://www.googleapis.com/compute/v1/projects/windows-cloud/global/images/windows-server-2022-dc-v20240214",
                    "labels": {},
                    "resource_manager_tags": null,
                    "size": 50,
                    "type": "pd-balanced"
                  }
                ],
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/disks/web1"
              }
            ],
            "can_ip_forward": false,
            "confidential_instance_config": [],
            "cpu_platform": "Intel Cascade Lake",
            "current_status": "RUNNING",
            "deletion_protection": false,
            "description": "",
            "desired_status": null,
            "enable_display": false,
            "guest_accelerator": [],
            "hostname": "",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/web1",
            "instance_id": "5500036342448624080",
            "label_fingerprint": "42WmSpB8rSM=",
            "labels": null,
            "machine_type": "n2-standard-4",
            "metadata": {
              "sysprep-specialize-script-ps1": "\u003c#**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *#\u003e\n\n### WEB SERVER CONFIGURATION SCRIPT ### \n\n#Generate Stage 1 Script\n'\n$ErrorActionPreference = \"Stop\"\n\n#Wait for OS to initialize\nStart-Sleep (60)\n\n#Add Bootstrapping Metadata to GCE Instance Metadata\ngcloud compute instances add-metadata web1 --zone=us-central1-f --metadata=STATUS=BOOTSTRAPPING\n\n#Disable Scheduled Task for Stage 1\nDisable-ScheduledTask -TaskName \"Web Server Bootstrap - Stage 1\"\n\n#Install required Windows features\n#Install-WindowsFeature Web-Server,Web-App-Dev,Web-Asp-Net,Web-Asp-Net45,Web-Net-Ext45,NET-Framework-Core,NET-Framework-45-ASPNET -IncludeManagementTools\nInstall-WindowsFeature Web-Default-Doc, Web-Filtering, Web-Windows-Auth, Web-Net-Ext45, Web-Asp-Net45, Web-ISAPI-Ext, Web-ISAPI-Filter, NET-Framework-Core, NET-Framework-45-Core, NET-Framework-45-ASPNET, NET-WCF-TCP-PortSharing45 -IncludeManagementTools\nSet-WebConfigurationProperty -filter /system.WebServer/security/authentication/AnonymousAuthentication -PSPath IIS:\\ -name enabled -value true\nSet-WebConfigurationProperty -filter /system.webServer/security/authentication/windowsAuthentication -PSPath IIS:\\ -name enabled -value true\n\n#Install Chrome\nStart-BitsTransfer -Source \"https://dl.google.com/chrome/install/latest/chrome_installer.exe\" -Destination \"C:\\chrome_installer.exe\"\nStart-Process \"C:\\chrome_installer.exe\" -ArgumentList \"/silent /install\" -Wait\n\n#Install SQL Server Management Studio\nStart-BitsTransfer -Source \"https://aka.ms/ssmsfullsetup\" -Destination \"C:\\ssms_setup.exe\"\nStart-Process \"C:\\ssms_setup.exe\" -ArgumentList \"/install /quiet\" -Wait\nCopy-Item \"C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Microsoft SQL Server Tools 19\\SQL Server Management Studio 19.lnk\" \"C:\\Users\\Public\\Desktop\"\n\n#Enable Local Administrator\n$local_admin_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=local-admin) -AsPlainText -Force\nGet-LocalUser -Name \"Administrator\" | Set-LocalUser -Password $local_admin_password\nGet-LocalUser -Name \"Administrator\" | Enable-LocalUser\n\n#Enable Scheduled Task for Stage 2\nEnable-ScheduledTask -TaskName \"Web Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 1\nUnregister-ScheduledTask -TaskName \"Web Server Bootstrap - Stage 1\" -Confirm:$false\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata web1 --zone=us-central1-f --metadata=STATUS=DOMAIN_READY_CHECK\n\n#Check if Domain Controller is ready and add this Server to Domain\n$DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\nwhile($DomainStatus -ne \"READY\")\n    {\n        Start-Sleep(5)\n        $DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\n    }\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata web1 --zone=us-central1-f --metadata=STATUS=JOINING_DOMAIN\n\n$ad_admin_user = \"administrator\"\n$ad_admin_username = \"example\" + \"\\\" + $ad_admin_user\n$domain_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $ad_admin_username, $local_admin_password\nAdd-Computer -Domain example.com -Credential $domain_credential -Restart -Force\n\n' | Out-File C:\\stage1.ps1\n\n#Generate Stage 2 Script\n'\n$ErrorActionPreference = \"SilentlyContinue\"\n\n#Disable Scheduled Task for Stage 2\nDisable-ScheduledTask -TaskName \"Web Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 2\nUnregister-ScheduledTask -TaskName \"Web Server Bootstrap - Stage 2\" -Confirm:$false\n\n#Set DNS Suffix and Register DNS Client\nSet-DNSClient -InterfaceAlias \"Ethernet\" -ConnectionSpecificSuffix \"example.com\"\nRegister-DnsClient\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata web1 --zone=us-central1-f --metadata=STATUS=CONFIGURING_WEBAPP\n\n#Configure Web App Pool\nImport-Module WebAdministration\n$AppPoolName = \"DefaultAppPool\"\n$websvc = \"example\\web-user\"\n$websvcpassword = gcloud secrets versions access latest --secret=web-service\nStop-WebAppPool -Name \"DefaultAppPool\"\nSet-ItemProperty IIS:\\AppPools\\$AppPoolName -name processModel -value @{userName=$websvc;password=$websvcpassword;identitytype=3}\nStart-Sleep(5)\nStart-WebAppPool -Name \"DefaultAppPool\"\n\n#Download Sample Web App\n#Start-BitsTransfer -Source \"https://docs.google.com/uc?export=download\u0026id=1x7G2mpySty_9r5KaWu3LVLOLTmbYzB9t\" -Destination \"C:\\samplewebapp.zip\"\nInvoke-WebRequest -Uri \"https://docs.google.com/uc?export=download\u0026id=1x7G2mpySty_9r5KaWu3LVLOLTmbYzB9t\" -Outfile \"C:\\samplewebapp.zip\"\n\n#Extract Web App\nExpand-Archive C:\\samplewebapp.zip C:\\inetpub\\wwwroot\\\n\n#Update Connection String\n$listenername = \"dnn-listener\"\n$listenerport = \"6789\"\nSet-WebConfigurationProperty -pspath \"IIS:\\Sites\\Default Web Site\\\" -Filter \"/connectionStrings/add[@name=''SchoolContext'']\" `\n-Name ''connectionString'' `\n-Value \"Data Source=$listenername,$listenerport;MultiSubnetFailover=True;Initial Catalog=ContosoUniversity;Integrated Security=SSPI;\"\nStop-Website -Name \"Default Web Site\"\nStart-WebSite -Name \"Default Web Site\"\n\n\n#Restart Website\nStop-Website -Name \"Default Web Site\"\nStart-Website -Name \"Default Web Site\"\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata web1 --zone=us-central1-f --metadata=STATUS=READY\n\n' | Out-File C:\\stage2.ps1\n\n$stage1_taskName = \"Web Server Bootstrap - Stage 1\"\n$s1action = New-ScheduledTaskAction -Execute 'PowerShell.exe' -Argument \"C:\\stage1.ps1\"\n$s1trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s1principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s1action -Trigger $s1trigger -Principal $s1principal -TaskName $stage1_taskName\n\n$stage2_taskName = \"Web Server Bootstrap - Stage 2\"\n$s2action = New-ScheduledTaskAction -Execute 'PowerShell.exe' -Argument \"C:\\stage2.ps1\"\n$s2trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s2principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s2action -Trigger $s2trigger -Principal $s2principal -TaskName $stage2_taskName\nDisable-ScheduledTask -TaskName \"Web Server Bootstrap - Stage 2\"\n\n#Disable Server Manager Startup\nGet-ScheduledTask -TaskName \"ServerManager\" | Disable-ScheduledTask"
            },
            "metadata_fingerprint": "nSRBgijIhcU=",
            "metadata_startup_script": null,
            "min_cpu_platform": "",
            "name": "web1",
            "network_interface": [
              {
                "access_config": [],
                "alias_ip_range": [],
                "internal_ipv6_prefix_length": 0,
                "ipv6_access_config": [],
                "ipv6_access_type": "",
                "ipv6_address": "",
                "name": "nic0",
                "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
                "network_ip": "10.145.0.4",
                "nic_type": "",
                "queue_count": 0,
                "stack_type": "IPV4_ONLY",
                "subnetwork": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
                "subnetwork_project": "sql-test-002-414415"
              }
            ],
            "network_performance_config": [],
            "params": [],
            "project": "sql-test-002-414415",
            "reservation_affinity": [],
            "resource_policies": null,
            "scheduling": [
              {
                "automatic_restart": true,
                "instance_termination_action": "",
                "local_ssd_recovery_timeout": [],
                "min_node_cpus": 0,
                "node_affinities": [],
                "on_host_maintenance": "MIGRATE",
                "preemptible": false,
                "provisioning_model": "STANDARD"
              }
            ],
            "scratch_disk": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/instances/web1",
            "service_account": [
              {
                "email": "prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
                "scopes": [
                  "https://www.googleapis.com/auth/cloud-platform"
                ]
              }
            ],
            "shielded_instance_config": [
              {
                "enable_integrity_monitoring": true,
                "enable_secure_boot": true,
                "enable_vtpm": true
              }
            ],
            "tags": [
              "rdp",
              "web"
            ],
            "tags_fingerprint": "DYjykZZ4rB4=",
            "timeouts": null,
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9",
          "dependencies": [
            "google_compute_instance.dc1",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance",
      "name": "witness",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 6,
          "attributes": {
            "advanced_machine_features": [],
            "allow_stopping_for_update": true,
            "attached_disk": [],
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "witness",
                "disk_encryption_key_raw": "",
                "disk_encryption_key_sha256": "",
                "initialize_params": [
                  {
                    "image": "https://www.googleapis.com/compute/v1/projects/windows-cloud/global/images/windows-server-2022-dc-v20240214",
                    "labels": {},
                    "resource_manager_tags": null,
                    "size": 50,
                    "type": "pd-balanced"
                  }
                ],
                "kms_key_self_link": "",
                "mode": "READ_WRITE",
                "source": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/disks/witness"
              }
            ],
            "can_ip_forward": false,
            "confidential_instance_config": [],
            "cpu_platform": "Intel Broadwell",
            "current_status": "RUNNING",
            "deletion_protection": false,
            "description": "",
            "desired_status": null,
            "enable_display": false,
            "guest_accelerator": [],
            "hostname": "",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/witness",
            "instance_id": "7826073523383931289",
            "label_fingerprint": "42WmSpB8rSM=",
            "labels": null,
            "machine_type": "e2-medium",
            "metadata": {
              "sysprep-specialize-script-ps1": "\u003c#**\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *#\u003e\n\n### CLUSTER WITNESS SERVER CONFIGURATION SCRIPT ### \n\n#Generate Stage 1 Script\n'\n$ErrorActionPreference = \"Stop\"\n\n#Wait for OS to initialize\nStart-Sleep (60)\n\n#Add Bootstrapping Metadata to GCE Instance Metadata\ngcloud compute instances add-metadata witness --zone=us-central1-f --metadata=STATUS=BOOTSTRAPPING\n\n#Disable Scheduled Task for Stage 1\nDisable-ScheduledTask -TaskName \"Witness Server Bootstrap - Stage 1\"\n\n#Install Chrome\nStart-BitsTransfer -Source \"https://dl.google.com/chrome/install/latest/chrome_installer.exe\" -Destination \"C:\\chrome_installer.exe\"\nStart-Process \"C:\\chrome_installer.exe\" -ArgumentList \"/silent /install\" -Wait\n\n#Enable Local Administrator\n$local_admin_password = ConvertTo-SecureString -String (gcloud secrets versions access latest --secret=local-admin) -AsPlainText -Force\nGet-LocalUser -Name \"Administrator\" | Set-LocalUser -Password $local_admin_password\nGet-LocalUser -Name \"Administrator\" | Enable-LocalUser\n\n#Enable Scheduled Task for Stage 2\nEnable-ScheduledTask -TaskName \"Witness Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 1\nUnregister-ScheduledTask -TaskName \"Witness Server Bootstrap - Stage 1\" -Confirm:$false\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata witness --zone=us-central1-f --metadata=STATUS=DOMAIN_READY_CHECK\n\n#Check if Domain Controller is ready and add this Server to Domain\n$DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\nwhile($DomainStatus -ne \"READY\")\n    {\n        Start-Sleep(5)\n        $DomainStatus = gcloud compute instances describe dc1 --zone=us-central1-f --format=\"value[](metadata.items.STATUS)\"\n    }\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata witness --zone=us-central1-f --metadata=STATUS=JOINING_DOMAIN\n\n$ad_admin_user = \"administrator\"\n$ad_admin_username = \"example\" + \"\\\" + $ad_admin_user\n$domain_credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $ad_admin_username, $local_admin_password\nAdd-Computer -Domain example.com -Credential $domain_credential -Restart -Force\n\n' | Out-File C:\\stage1.ps1\n\n#Generate Stage 2 Script\n'\n$ErrorActionPreference = \"SilentlyContinue\"\n\n#Disable Scheduled Task for Stage 2\nDisable-ScheduledTask -TaskName \"Witness Server Bootstrap - Stage 2\"\n\n#Unregister Scheduled Task for Stage 2\n#Unregister-ScheduledTask -TaskName \"Witness Server Bootstrap - Stage 2\" -Confirm:$false\n\n#Set DNS Suffix and Register DNS Client\nSet-DNSClient -InterfaceAlias \"Ethernet\" -ConnectionSpecificSuffix \"example.com\"\nRegister-DnsClient\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata witness --zone=us-central1-f --metadata=STATUS=CREATING_FILESHARE\n\n#Create File Share for Cluster Quorum\nNew-Item \"C:\\QWitness\" -Type directory\nNew-Item \"C:\\Backup\" -Type directory\nicacls C:\\QWitness\\ /grant \"Everyone:(OI)(CI)(M)\"\nicacls C:\\Backup\\ /grant \"Everyone:(OI)(CI)(M)\"\n\nNew-SmbShare -Name QWitness -Path \"C:\\QWitness\" -Description \"SQL File Share Witness\" -FullAccess \"Everyone\"\nNew-SmbShare -Name Backup -Path \"C:\\Backup\" -Description \"SQL Backup\" -FullAccess \"Everyone\"\n\n#Update Bootstrapping Metadata\ngcloud compute instances add-metadata witness --zone=us-central1-f --metadata=STATUS=READY\n\n' | Out-File C:\\stage2.ps1\n\n$stage1_taskName = \"Witness Server Bootstrap - Stage 1\"\n$s1action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage1.ps1\"\n$s1trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s1principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s1action -Trigger $s1trigger -Principal $s1principal -TaskName $stage1_taskName\n\n$stage2_taskName = \"Witness Server Bootstrap - Stage 2\"\n$s2action = New-ScheduledTaskAction -Execute 'PowerShell.exe' `\n  -Argument \"C:\\stage2.ps1\"\n$s2trigger = New-ScheduledTaskTrigger -AtStartup\n\n$s2principal =  New-ScheduledTaskPrincipal -UserID \"NT AUTHORITY\\SYSTEM\" -LogonType ServiceAccount\nRegister-ScheduledTask -Action $s2action -Trigger $s2trigger -Principal $s2principal -TaskName $stage2_taskName\nDisable-ScheduledTask -TaskName \"Witness Server Bootstrap - Stage 2\"\n\n#Disable Server Manager Startup\nGet-ScheduledTask -TaskName \"ServerManager\" | Disable-ScheduledTask"
            },
            "metadata_fingerprint": "NEVX5S0UTLc=",
            "metadata_startup_script": null,
            "min_cpu_platform": "",
            "name": "witness",
            "network_interface": [
              {
                "access_config": [],
                "alias_ip_range": [],
                "internal_ipv6_prefix_length": 0,
                "ipv6_access_config": [],
                "ipv6_access_type": "",
                "ipv6_address": "",
                "name": "nic0",
                "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
                "network_ip": "10.145.0.7",
                "nic_type": "",
                "queue_count": 0,
                "stack_type": "IPV4_ONLY",
                "subnetwork": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
                "subnetwork_project": "sql-test-002-414415"
              }
            ],
            "network_performance_config": [],
            "params": [],
            "project": "sql-test-002-414415",
            "reservation_affinity": [],
            "resource_policies": null,
            "scheduling": [
              {
                "automatic_restart": true,
                "instance_termination_action": "",
                "local_ssd_recovery_timeout": [],
                "min_node_cpus": 0,
                "node_affinities": [],
                "on_host_maintenance": "MIGRATE",
                "preemptible": false,
                "provisioning_model": "STANDARD"
              }
            ],
            "scratch_disk": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/zones/us-central1-f/instances/witness",
            "service_account": [
              {
                "email": "prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
                "scopes": [
                  "https://www.googleapis.com/auth/cloud-platform"
                ]
              }
            ],
            "shielded_instance_config": [
              {
                "enable_integrity_monitoring": true,
                "enable_secure_boot": true,
                "enable_vtpm": true
              }
            ],
            "tags": [
              "file",
              "rdp",
              "witness"
            ],
            "tags_fingerprint": "YBwS3MUmQt0=",
            "timeouts": null,
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9",
          "dependencies": [
            "google_compute_instance.dc1",
            "google_compute_instance.sql2",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance_iam_member",
      "name": "reset_gce_vm",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "index_key": "sql1",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWRRGVg=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql1/projects/sql-test-002-414415/roles/reset_gce_vm/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql1",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/reset_gce_vm",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_project_iam_custom_role.reset_gce_vm",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "sql2",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWRQ3GM=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql2/projects/sql-test-002-414415/roles/reset_gce_vm/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql2",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/reset_gce_vm",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_project_iam_custom_role.reset_gce_vm",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "web1",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWRQ0-E=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/web1/projects/sql-test-002-414415/roles/reset_gce_vm/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/web1",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/reset_gce_vm",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_project_iam_custom_role.reset_gce_vm",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_instance_iam_member",
      "name": "update_instance_metadata",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "index_key": "dc1",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWXO4qA=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/dc1/projects/sql-test-002-414415/roles/metadata_manager/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/dc1",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/metadata_manager",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.jumpbox",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_compute_instance.witness",
            "google_project_iam_custom_role.metadata_manager",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "jumpbox",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWXOSJU=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/jumpbox/projects/sql-test-002-414415/roles/metadata_manager/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/jumpbox",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/metadata_manager",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.jumpbox",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_compute_instance.witness",
            "google_project_iam_custom_role.metadata_manager",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "sql1",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWXOkxU=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql1/projects/sql-test-002-414415/roles/metadata_manager/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql1",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/metadata_manager",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.jumpbox",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_compute_instance.witness",
            "google_project_iam_custom_role.metadata_manager",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "sql2",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWXO2po=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql2/projects/sql-test-002-414415/roles/metadata_manager/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/sql2",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/metadata_manager",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.jumpbox",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_compute_instance.witness",
            "google_project_iam_custom_role.metadata_manager",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "web1",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWXO87c=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/web1/projects/sql-test-002-414415/roles/metadata_manager/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/web1",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/metadata_manager",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.jumpbox",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_compute_instance.witness",
            "google_project_iam_custom_role.metadata_manager",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "witness",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbWXPVVM=",
            "id": "projects/sql-test-002-414415/zones/us-central1-f/instances/witness/projects/sql-test-002-414415/roles/metadata_manager/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "instance_name": "projects/sql-test-002-414415/zones/us-central1-f/instances/witness",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "projects/sql-test-002-414415/roles/metadata_manager",
            "zone": "us-central1-f"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.jumpbox",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_compute_instance.witness",
            "google_project_iam_custom_role.metadata_manager",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_compute_router",
      "name": "prod_nat_router",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bgp": [],
            "creation_timestamp": "2024-02-15T07:33:51.084-08:00",
            "description": "",
            "encrypted_interconnect_router": false,
            "id": "projects/sql-test-002-414415/regions/us-central1/routers/prod-natgw-router",
            "name": "prod-natgw-router",
            "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
            "project": "sql-test-002-414415",
            "region": "us-central1",
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/routers/prod-natgw-router",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "module.prod_vpc.module.vpc.google_compute_network.network"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_dns_managed_zone",
      "name": "prod_dns_zone",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cloud_logging_config": [
              {
                "enable_logging": false
              }
            ],
            "creation_time": "2024-02-15T15:35:27.127Z",
            "description": "example.com Private Cloud DNS Zone",
            "dns_name": "example.com.",
            "dnssec_config": [],
            "force_destroy": false,
            "forwarding_config": [
              {
                "target_name_servers": [
                  {
                    "forwarding_path": "",
                    "ipv4_address": "10.145.0.3"
                  }
                ]
              }
            ],
            "id": "projects/sql-test-002-414415/managedZones/example-com",
            "labels": null,
            "managed_zone_id": 4471670373066552293,
            "name": "example-com",
            "name_servers": [
              "ns-gcp-private.googledomains.com."
            ],
            "peering_config": [],
            "private_visibility_config": [
              {
                "gke_clusters": [],
                "networks": [
                  {
                    "network_url": "projects/sql-test-002-414415/global/networks/prod-vpc"
                  }
                ]
              }
            ],
            "project": "sql-test-002-414415",
            "timeouts": null,
            "visibility": "private"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_compute_instance.dc1",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "module.prod_vpc.module.vpc.google_compute_shared_vpc_host_project.shared_vpc_host",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_project_iam_custom_role",
      "name": "metadata_manager",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "deleted": false,
            "description": "Custom Role to allow Read and Update of Instance Metadata",
            "id": "projects/sql-test-002-414415/roles/metadata_manager",
            "name": "projects/sql-test-002-414415/roles/metadata_manager",
            "permissions": [
              "compute.instances.get",
              "compute.instances.setMetadata"
            ],
            "project": "sql-test-002-414415",
            "role_id": "metadata_manager",
            "stage": "GA",
            "title": "Metadata Manager"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_project_iam_custom_role",
      "name": "reset_gce_vm",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "deleted": false,
            "description": "Custom Role to allow resetting a GCE VM",
            "id": "projects/sql-test-002-414415/roles/reset_gce_vm",
            "name": "projects/sql-test-002-414415/roles/reset_gce_vm",
            "permissions": [
              "compute.instances.reset",
              "compute.instances.start",
              "compute.instances.stop"
            ],
            "project": "sql-test-002-414415",
            "role_id": "reset_gce_vm",
            "stage": "GA",
            "title": "GCE Reset"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_project_service",
      "name": "provider_project_apis",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "index_key": "cloudresourcemanager.googleapis.com",
          "schema_version": 0,
          "attributes": {
            "disable_dependent_services": null,
            "disable_on_destroy": true,
            "id": "sql-test-002-414415/cloudresourcemanager.googleapis.com",
            "project": "sql-test-002-414415",
            "service": "cloudresourcemanager.googleapis.com",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInJlYWQiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDAwfX0="
        },
        {
          "index_key": "compute.googleapis.com",
          "schema_version": 0,
          "attributes": {
            "disable_dependent_services": null,
            "disable_on_destroy": true,
            "id": "sql-test-002-414415/compute.googleapis.com",
            "project": "sql-test-002-414415",
            "service": "compute.googleapis.com",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInJlYWQiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDAwfX0="
        },
        {
          "index_key": "dns.googleapis.com",
          "schema_version": 0,
          "attributes": {
            "disable_dependent_services": null,
            "disable_on_destroy": true,
            "id": "sql-test-002-414415/dns.googleapis.com",
            "project": "sql-test-002-414415",
            "service": "dns.googleapis.com",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInJlYWQiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDAwfX0="
        },
        {
          "index_key": "iam.googleapis.com",
          "schema_version": 0,
          "attributes": {
            "disable_dependent_services": null,
            "disable_on_destroy": true,
            "id": "sql-test-002-414415/iam.googleapis.com",
            "project": "sql-test-002-414415",
            "service": "iam.googleapis.com",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInJlYWQiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDAwfX0="
        },
        {
          "index_key": "secretmanager.googleapis.com",
          "schema_version": 0,
          "attributes": {
            "disable_dependent_services": null,
            "disable_on_destroy": true,
            "id": "sql-test-002-414415/secretmanager.googleapis.com",
            "project": "sql-test-002-414415",
            "service": "secretmanager.googleapis.com",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInJlYWQiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret",
      "name": "ad_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "annotations": null,
            "create_time": "2024-02-15T15:35:10.232698Z",
            "expire_time": "",
            "id": "projects/sql-test-002-414415/secrets/example-com-admin",
            "labels": {
              "label": "example-com-admin"
            },
            "name": "projects/666759327177/secrets/example-com-admin",
            "project": "sql-test-002-414415",
            "replication": [
              {
                "auto": [
                  {
                    "customer_managed_encryption": []
                  }
                ],
                "automatic": false,
                "user_managed": []
              }
            ],
            "rotation": [],
            "secret_id": "example-com-admin",
            "timeouts": null,
            "topics": [],
            "ttl": null,
            "version_aliases": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret",
      "name": "ad_user_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "annotations": null,
            "create_time": "2024-02-15T15:35:10.246257Z",
            "expire_time": "",
            "id": "projects/sql-test-002-414415/secrets/example-com-user",
            "labels": {
              "label": "example-com-user"
            },
            "name": "projects/666759327177/secrets/example-com-user",
            "project": "sql-test-002-414415",
            "replication": [
              {
                "auto": [
                  {
                    "customer_managed_encryption": []
                  }
                ],
                "automatic": false,
                "user_managed": []
              }
            ],
            "rotation": [],
            "secret_id": "example-com-user",
            "timeouts": null,
            "topics": [],
            "ttl": null,
            "version_aliases": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret",
      "name": "adds_dsrm",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "annotations": null,
            "create_time": "2024-02-15T15:35:10.305816Z",
            "expire_time": "",
            "id": "projects/sql-test-002-414415/secrets/example-com-dsrm",
            "labels": {
              "label": "example-com-dsrm"
            },
            "name": "projects/666759327177/secrets/example-com-dsrm",
            "project": "sql-test-002-414415",
            "replication": [
              {
                "auto": [
                  {
                    "customer_managed_encryption": []
                  }
                ],
                "automatic": false,
                "user_managed": []
              }
            ],
            "rotation": [],
            "secret_id": "example-com-dsrm",
            "timeouts": null,
            "topics": [],
            "ttl": null,
            "version_aliases": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret",
      "name": "local_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "annotations": null,
            "create_time": "2024-02-15T15:35:10.319376Z",
            "expire_time": "",
            "id": "projects/sql-test-002-414415/secrets/local-admin",
            "labels": {
              "label": "local-administrator"
            },
            "name": "projects/666759327177/secrets/local-admin",
            "project": "sql-test-002-414415",
            "replication": [
              {
                "auto": [
                  {
                    "customer_managed_encryption": []
                  }
                ],
                "automatic": false,
                "user_managed": []
              }
            ],
            "rotation": [],
            "secret_id": "local-admin",
            "timeouts": null,
            "topics": [],
            "ttl": null,
            "version_aliases": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret",
      "name": "sql_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "annotations": null,
            "create_time": "2024-02-15T15:35:10.078284Z",
            "expire_time": "",
            "id": "projects/sql-test-002-414415/secrets/sql-service",
            "labels": {
              "label": "sql-service"
            },
            "name": "projects/666759327177/secrets/sql-service",
            "project": "sql-test-002-414415",
            "replication": [
              {
                "auto": [
                  {
                    "customer_managed_encryption": []
                  }
                ],
                "automatic": false,
                "user_managed": []
              }
            ],
            "rotation": [],
            "secret_id": "sql-service",
            "timeouts": null,
            "topics": [],
            "ttl": null,
            "version_aliases": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret",
      "name": "web_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "annotations": null,
            "create_time": "2024-02-15T15:35:10.330893Z",
            "expire_time": "",
            "id": "projects/sql-test-002-414415/secrets/web-service",
            "labels": {
              "label": "web-service"
            },
            "name": "projects/666759327177/secrets/web-service",
            "project": "sql-test-002-414415",
            "replication": [
              {
                "auto": [
                  {
                    "customer_managed_encryption": []
                  }
                ],
                "automatic": false,
                "user_managed": []
              }
            ],
            "rotation": [],
            "secret_id": "web-service",
            "timeouts": null,
            "topics": [],
            "ttl": null,
            "version_aliases": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret_iam_member",
      "name": "prod_compute_service_account",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "index_key": "example-com-admin",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV+4FbY=",
            "id": "projects/sql-test-002-414415/secrets/example-com-admin/roles/secretmanager.secretAccessor/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "roles/secretmanager.secretAccessor",
            "secret_id": "projects/sql-test-002-414415/secrets/example-com-admin"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "example-com-dsrm",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV95fNU=",
            "id": "projects/sql-test-002-414415/secrets/example-com-dsrm/roles/secretmanager.secretAccessor/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "roles/secretmanager.secretAccessor",
            "secret_id": "projects/sql-test-002-414415/secrets/example-com-dsrm"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "example-com-user",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV95fvE=",
            "id": "projects/sql-test-002-414415/secrets/example-com-user/roles/secretmanager.secretAccessor/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "roles/secretmanager.secretAccessor",
            "secret_id": "projects/sql-test-002-414415/secrets/example-com-user"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "local-admin",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV968+c=",
            "id": "projects/sql-test-002-414415/secrets/local-admin/roles/secretmanager.secretAccessor/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "roles/secretmanager.secretAccessor",
            "secret_id": "projects/sql-test-002-414415/secrets/local-admin"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "sql-service",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV+eKHw=",
            "id": "projects/sql-test-002-414415/secrets/sql-service/roles/secretmanager.secretAccessor/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "roles/secretmanager.secretAccessor",
            "secret_id": "projects/sql-test-002-414415/secrets/sql-service"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        },
        {
          "index_key": "web-service",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV+fseQ=",
            "id": "projects/sql-test-002-414415/secrets/web-service/roles/secretmanager.secretAccessor/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "roles/secretmanager.secretAccessor",
            "secret_id": "projects/sql-test-002-414415/secrets/web-service"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret_iam_member",
      "name": "prod_compute_service_account_secretVersionAdder",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "index_key": "example-com-admin",
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV+4FbY=",
            "id": "projects/sql-test-002-414415/secrets/example-com-admin/roles/secretmanager.secretVersionAdder/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "role": "roles/secretmanager.secretVersionAdder",
            "secret_id": "projects/sql-test-002-414415/secrets/example-com-admin"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret_version",
      "name": "ad_user_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_time": "2024-02-15T15:35:12.766123Z",
            "deletion_policy": "DELETE",
            "destroy_time": "",
            "enabled": true,
            "id": "projects/666759327177/secrets/example-com-user/versions/1",
            "is_secret_data_base64": false,
            "name": "projects/666759327177/secrets/example-com-user/versions/1",
            "secret": "projects/sql-test-002-414415/secrets/example-com-user",
            "secret_data": "3hXtS-XmnV[",
            "timeouts": null,
            "version": "1"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_data"
              }
            ]
          ],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_user_password",
            "random_password.ad_user_password",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret_version",
      "name": "adds_dsrm",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_time": "2024-02-15T15:35:12.729409Z",
            "deletion_policy": "DELETE",
            "destroy_time": "",
            "enabled": true,
            "id": "projects/666759327177/secrets/example-com-dsrm/versions/1",
            "is_secret_data_base64": false,
            "name": "projects/666759327177/secrets/example-com-dsrm/versions/1",
            "secret": "projects/sql-test-002-414415/secrets/example-com-dsrm",
            "secret_data": "rvX8K9XfEyOOe0l",
            "timeouts": null,
            "version": "1"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_data"
              }
            ]
          ],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.adds_dsrm",
            "random_password.adds_dsrm",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret_version",
      "name": "local_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_time": "2024-02-15T15:35:12.999888Z",
            "deletion_policy": "DELETE",
            "destroy_time": "",
            "enabled": true,
            "id": "projects/666759327177/secrets/local-admin/versions/1",
            "is_secret_data_base64": false,
            "name": "projects/666759327177/secrets/local-admin/versions/1",
            "secret": "projects/sql-test-002-414415/secrets/local-admin",
            "secret_data": "=\u003eXRsSn}yf7{U=T",
            "timeouts": null,
            "version": "1"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_data"
              }
            ]
          ],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.local_admin",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret_version",
      "name": "sql_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_time": "2024-02-15T15:35:12.610046Z",
            "deletion_policy": "DELETE",
            "destroy_time": "",
            "enabled": true,
            "id": "projects/666759327177/secrets/sql-service/versions/1",
            "is_secret_data_base64": false,
            "name": "projects/666759327177/secrets/sql-service/versions/1",
            "secret": "projects/sql-test-002-414415/secrets/sql-service",
            "secret_data": "\u0026O[MqDZ=5NCX3#=",
            "timeouts": null,
            "version": "1"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_data"
              }
            ]
          ],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.sql_service",
            "random_password.sql_service_password",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_secret_manager_secret_version",
      "name": "web_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_time": "2024-02-15T15:35:13.009912Z",
            "deletion_policy": "DELETE",
            "destroy_time": "",
            "enabled": true,
            "id": "projects/666759327177/secrets/web-service/versions/1",
            "is_secret_data_base64": false,
            "name": "projects/666759327177/secrets/web-service/versions/1",
            "secret": "projects/sql-test-002-414415/secrets/web-service",
            "secret_data": "+r{ZdCsw$QVLkku",
            "timeouts": null,
            "version": "1"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_data"
              }
            ]
          ],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.web_service",
            "random_password.web_service_password",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_service_account",
      "name": "prod_compute_service_account",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "prod-compute-service-account",
            "description": "",
            "disabled": false,
            "display_name": "Service Account for Compute Engine Instances in Prod",
            "email": "prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "id": "projects/sql-test-002-414415/serviceAccounts/prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "name": "projects/sql-test-002-414415/serviceAccounts/prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "project": "sql-test-002-414415",
            "timeouts": null,
            "unique_id": "108315615911791857125"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "google_service_account_iam_member",
      "name": "prod_compute_service_account_serviceAccountUser",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": [],
            "etag": "BwYRbV924Pk=",
            "id": "projects/sql-test-002-414415/serviceAccounts/prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com/roles/iam.serviceAccountUser/serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "member": "serviceAccount:prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com",
            "role": "roles/iam.serviceAccountUser",
            "service_account_id": "projects/sql-test-002-414415/serviceAccounts/prod-compute-service-account@sql-test-002-414415.iam.gserviceaccount.com"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "google_service_account.prod_compute_service_account",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_password",
      "name": "ad_user_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$mR26X/imHp6cAipPSLKUheMPDyAnaXXrb6w1EH5zVVevjGwCrFkl2",
            "id": "none",
            "keepers": null,
            "length": 11,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}\u003c\u003e:?",
            "result": "3hXtS-XmnV[",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_password",
      "name": "adds_dsrm",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$7ODZlTbE3q.2l6Ey94oUaef/7rAoFmhUj973KlxdQeFFZiwbyqj92",
            "id": "none",
            "keepers": null,
            "length": 15,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}\u003c\u003e:?",
            "result": "rvX8K9XfEyOOe0l",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_password",
      "name": "local_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$RcXf90nJNChId.UJ87F9CuNufpIbK5J/iVZlxtBAKRMWIbYBcw7Z2",
            "id": "none",
            "keepers": null,
            "length": 15,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}\u003c\u003e:?",
            "result": "=\u003eXRsSn}yf7{U=T",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_password",
      "name": "sql_service_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$2UKkmn1Tx97Vun.vpDCc8.Kw9yT4Z67cD4jsaOr3iA73zRHOOmq3G",
            "id": "none",
            "keepers": null,
            "length": 15,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}\u003c\u003e:?",
            "result": "\u0026O[MqDZ=5NCX3#=",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_password",
      "name": "web_service_password",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 3,
          "attributes": {
            "bcrypt_hash": "$2a$10$pQT6Q4d7cCbkJBw6CrDgKOoBU238ehF9N7mDm1Vf0.MdDrat5Kt56",
            "id": "none",
            "keepers": null,
            "length": 15,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": "!#$%\u0026*()-_=+[]{}\u003c\u003e:?",
            "result": "+r{ZdCsw$QVLkku",
            "special": true,
            "upper": true
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "time_sleep",
      "name": "api_cool_down_timer",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "90s",
            "destroy_duration": null,
            "id": "2024-02-15T15:35:08Z",
            "triggers": null
          },
          "sensitive_attributes": [],
          "dependencies": [
            "google_project_service.provider_project_apis"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "time_sleep",
      "name": "environment_configuration_timer",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "15m",
            "destroy_duration": null,
            "id": "2024-02-15T15:52:01Z",
            "triggers": null
          },
          "sensitive_attributes": [],
          "dependencies": [
            "google_compute_address.wsfc_cluster_ip",
            "google_compute_instance.dc1",
            "google_compute_instance.jumpbox",
            "google_compute_instance.sql1",
            "google_compute_instance.sql2",
            "google_compute_instance.web1",
            "google_compute_instance.witness",
            "google_compute_instance_iam_member.update_instance_metadata",
            "google_project_iam_custom_role.metadata_manager",
            "google_project_service.provider_project_apis",
            "google_secret_manager_secret.ad_admin",
            "google_secret_manager_secret.ad_user_password",
            "google_secret_manager_secret.adds_dsrm",
            "google_secret_manager_secret.local_admin",
            "google_secret_manager_secret.sql_service",
            "google_secret_manager_secret.web_service",
            "google_secret_manager_secret_version.adds_dsrm",
            "google_secret_manager_secret_version.local_admin",
            "google_service_account.prod_compute_service_account",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "random_password.adds_dsrm",
            "random_password.local_admin",
            "time_sleep.api_cool_down_timer"
          ]
        }
      ]
    },
    {
      "module": "module.prod_firewall_rules",
      "mode": "managed",
      "type": "google_compute_firewall",
      "name": "rules",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "index_key": "allow-google-dns-proxy-prod-vpc",
          "schema_version": 1,
          "attributes": {
            "allow": [
              {
                "ports": [
                  "53"
                ],
                "protocol": "tcp"
              },
              {
                "ports": [
                  "53"
                ],
                "protocol": "udp"
              }
            ],
            "creation_timestamp": "2024-02-15T07:34:03.020-08:00",
            "deny": [],
            "description": "Allow Google DNS to forward DNS queries to Domain Controller",
            "destination_ranges": [],
            "direction": "INGRESS",
            "disabled": false,
            "enable_logging": null,
            "id": "projects/sql-test-002-414415/global/firewalls/allow-google-dns-proxy-prod-vpc",
            "log_config": [
              {
                "metadata": "INCLUDE_ALL_METADATA"
              }
            ],
            "name": "allow-google-dns-proxy-prod-vpc",
            "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
            "priority": 1000,
            "project": "sql-test-002-414415",
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/firewalls/allow-google-dns-proxy-prod-vpc",
            "source_ranges": [
              "35.199.192.0/19"
            ],
            "source_service_accounts": null,
            "source_tags": null,
            "target_service_accounts": null,
            "target_tags": [
              "dc"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network"
          ]
        },
        {
          "index_key": "allow-iap-tcp-forwarding-prod-vpc",
          "schema_version": 1,
          "attributes": {
            "allow": [
              {
                "ports": [
                  "22",
                  "3389"
                ],
                "protocol": "tcp"
              }
            ],
            "creation_timestamp": "2024-02-15T07:34:03.260-08:00",
            "deny": [],
            "description": "Allow Google Cloud IAP TCP Forwarding",
            "destination_ranges": [],
            "direction": "INGRESS",
            "disabled": false,
            "enable_logging": null,
            "id": "projects/sql-test-002-414415/global/firewalls/allow-iap-tcp-forwarding-prod-vpc",
            "log_config": [
              {
                "metadata": "INCLUDE_ALL_METADATA"
              }
            ],
            "name": "allow-iap-tcp-forwarding-prod-vpc",
            "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
            "priority": 1000,
            "project": "sql-test-002-414415",
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/firewalls/allow-iap-tcp-forwarding-prod-vpc",
            "source_ranges": [
              "35.235.240.0/20"
            ],
            "source_service_accounts": null,
            "source_tags": null,
            "target_service_accounts": null,
            "target_tags": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network"
          ]
        },
        {
          "index_key": "allow-internal-prod-vpc",
          "schema_version": 1,
          "attributes": {
            "allow": [
              {
                "ports": [],
                "protocol": "all"
              }
            ],
            "creation_timestamp": "2024-02-15T07:34:04.803-08:00",
            "deny": [],
            "description": "Allow all internal communication",
            "destination_ranges": [],
            "direction": "INGRESS",
            "disabled": false,
            "enable_logging": null,
            "id": "projects/sql-test-002-414415/global/firewalls/allow-internal-prod-vpc",
            "log_config": [
              {
                "metadata": "INCLUDE_ALL_METADATA"
              }
            ],
            "name": "allow-internal-prod-vpc",
            "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
            "priority": 1000,
            "project": "sql-test-002-414415",
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/firewalls/allow-internal-prod-vpc",
            "source_ranges": [
              "10.145.0.0/24"
            ],
            "source_service_accounts": null,
            "source_tags": null,
            "target_service_accounts": null,
            "target_tags": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "module.prod_vpc.module.subnets.google_compute_subnetwork.subnetwork",
            "module.prod_vpc.module.vpc.google_compute_network.network"
          ]
        }
      ]
    },
    {
      "module": "module.prod_vpc.module.subnets",
      "mode": "managed",
      "type": "google_compute_subnetwork",
      "name": "subnetwork",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "index_key": "us-central1/prod-subnet-us-central1",
          "schema_version": 0,
          "attributes": {
            "creation_timestamp": "2024-02-15T07:33:52.021-08:00",
            "description": "",
            "external_ipv6_prefix": "",
            "fingerprint": null,
            "gateway_address": "10.145.0.1",
            "id": "projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
            "internal_ipv6_prefix": "",
            "ip_cidr_range": "10.145.0.0/24",
            "ipv6_access_type": "",
            "ipv6_cidr_range": "",
            "log_config": [],
            "name": "prod-subnet-us-central1",
            "network": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
            "private_ip_google_access": true,
            "private_ipv6_google_access": "DISABLE_GOOGLE_ACCESS",
            "project": "sql-test-002-414415",
            "purpose": "PRIVATE",
            "region": "us-central1",
            "role": "",
            "secondary_ip_range": [],
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/regions/us-central1/subnetworks/prod-subnet-us-central1",
            "stack_type": "IPV4_ONLY",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis",
            "module.prod_vpc.module.vpc.google_compute_network.network"
          ]
        }
      ]
    },
    {
      "module": "module.prod_vpc.module.vpc",
      "mode": "managed",
      "type": "google_compute_network",
      "name": "network",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "auto_create_subnetworks": false,
            "delete_default_routes_on_create": false,
            "description": "",
            "enable_ula_internal_ipv6": false,
            "gateway_ipv4": "",
            "id": "projects/sql-test-002-414415/global/networks/prod-vpc",
            "internal_ipv6_range": "",
            "mtu": 1500,
            "name": "prod-vpc",
            "network_firewall_policy_enforcement_order": "AFTER_CLASSIC_FIREWALL",
            "project": "sql-test-002-414415",
            "routing_mode": "GLOBAL",
            "self_link": "https://www.googleapis.com/compute/v1/projects/sql-test-002-414415/global/networks/prod-vpc",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_project_service.provider_project_apis"
          ]
        }
      ]
    },
    {
      "module": "module.prod_vpc_cloud_nat",
      "mode": "managed",
      "type": "google_compute_router_nat",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/google\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "drain_nat_ips": null,
            "enable_dynamic_port_allocation": false,
            "enable_endpoint_independent_mapping": true,
            "icmp_idle_timeout_sec": 30,
            "id": "sql-test-002-414415/us-central1/prod-natgw-router/prod-natgw",
            "log_config": [],
            "max_ports_per_vm": 0,
            "min_ports_per_vm": 64,
            "name": "prod-natgw",
            "nat_ip_allocate_option": "AUTO_ONLY",
            "nat_ips": null,
            "project": "sql-test-002-414415",
            "region": "us-central1",
            "router": "prod-natgw-router",
            "rules": [],
            "source_subnetwork_ip_ranges_to_nat": "ALL_SUBNETWORKS_ALL_IP_RANGES",
            "subnetwork": [],
            "tcp_established_idle_timeout_sec": 1200,
            "tcp_time_wait_timeout_sec": 120,
            "tcp_transitory_idle_timeout_sec": 30,
            "timeouts": null,
            "udp_idle_timeout_sec": 30
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "google_compute_router.prod_nat_router",
            "google_project_service.provider_project_apis",
            "module.prod_vpc.module.vpc.google_compute_network.network",
            "module.prod_vpc_cloud_nat.google_compute_router.router",
            "module.prod_vpc_cloud_nat.random_string.name_suffix"
          ]
        }
      ]
    },
    {
      "module": "module.prod_vpc_cloud_nat",
      "mode": "managed",
      "type": "random_string",
      "name": "name_suffix",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "id": "rjum5o",
            "keepers": null,
            "length": 6,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": null,
            "result": "rjum5o",
            "special": false,
            "upper": false
          },
          "sensitive_attributes": []
        }
      ]
    }
  ],
  "check_results": null
}
